navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var localStream,connectedCall,peer=new Peer({key:"7a742a5a-7559-11e4-8696-b185a1e13bee",debug:3});peer.on("open",function(){$("#my-id").text(peer.id)}),peer.on("call",function(a){connectedCall=a,$("#peer-id").text(a.peer),a.answer(localStream),a.on("stream",function(a){var b=URL.createObjectURL(a);$("#peer-video").prop("src",b)})}),$(function(){navigator.getUserMedia({audio:!0,video:!0},function(a){localStream=a;var b=URL.createObjectURL(a);$("#my-video").prop("src",b)},function(){alert("Error!")}),$("#call-start").click(function(){var a=$("#peer-id-input").val(),b=peer.call(a,localStream);b.on("stream",function(a){$("#peer-id").text(b.peer);var c=URL.createObjectURL(a);$("#peer-video").prop("src",c)})}),$("#call-end").click(function(){connectedCall.close()})});